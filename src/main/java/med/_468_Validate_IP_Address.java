package _5_Longest_Palindromic_Substring;

import static org.testng.Assert.assertEquals;

/**
 * Created by udaythota on 7/30/19.
 * <p>
 * Write a function to check whether an input string is a valid IPv4 address or IPv6 address or neither.
 * </p>
 */
public class _468_Validate_IP_Address {
    // core logic: have different utility methods for validating IPv4 & IPv6. Make sure to cover all the corner cases
    private static String validIPAddress(String IP) {
        if (IP == null || IP.length() == 0) {
            return "Neither";
        }
        if (isValidIpv4(IP)) {
            return "IPv4";
        } else if (isValidIpv6(IP)) {
            return "IPv6";
        } else {
            return "Neither";
        }
    }

    private static boolean isValidIpv4(String inputString) {
        if (inputString.charAt(0) == '.' || inputString.charAt(inputString.length() - 1) == '.') {
            return false;
        }

        String[] split = inputString.split("\\.");
        if (split.length != 4) {
            return false;
        }
        for (String token : split) {
            try {
                if ((token.startsWith("0") && token.length() > 1) || token.length() == 0) {
                    return false;
                }
                if (!isNumeric(token) || Integer.parseInt(token) < 0 || Integer.parseInt(token) > 255) {
                    return false;
                }
            } catch (NumberFormatException ex) {
                System.out.println("Number format exception encountered");
                return false;
            }
        }
        return true;
    }

    private static boolean isValidIpv6(String inputString) {
        if (inputString.charAt(0) == ':' || inputString.charAt(inputString.length() - 1) == ':') {  // this is to handle the test case with empty first or last token: eg: 2001:0db8:85a3:0:0:8A2E:0370:7334:
            return false;
        }

        String[] split = inputString.split(":");
        if (split.length != 8) {
            return false;
        }

        for (String token : split) {
            if (token.length() == 0 || token.length() > 4) {
                return false;
            }
            for (Character ch : token.toCharArray()) {
                if ((ch >= '0' && ch <= '9') || (ch >= 'a' && ch <= 'f') || (ch >= 'A' && ch <= 'F')) {
                    continue;
                } else {
                    return false;
                }
            }
        }
        return true;
    }

    // to check if the given digit is a number
    private static boolean isNumeric(String string) {
        for (Character character : string.toCharArray()) {
            if (!Character.isDigit(character)) {
                return false;
            }
        }
        return true;
    }

    public static void main(String[] args) {
        assertEquals(validIPAddress("172.16.254.1"), "IPv4");
        assertEquals(validIPAddress("2001:0db8:85a3:0:0:8A2E:0370:7334"), "IPv6");
        assertEquals(validIPAddress("256.256.256.256"), "Neither");
        assertEquals(validIPAddress("12..33.4"), "Neither");
        assertEquals(validIPAddress("2001:0db8:85a3:0:0:8A2E:0370:7334:"), "Neither");
        assertEquals(validIPAddress("20EE:Fb8:85a3:0:0:8A2E:0370:7334:12"), "Neither");
        assertEquals(validIPAddress("1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111.1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111.1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111.1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111"), "Neither");
    }
}